(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.canvastext = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var canvastext,drawtext,fontHeight;fontHeight=require("./fontHeight"),drawtext=function(e,t,r,n,a){var c,i,l,h,s,o;for(s=fontHeight("font: "+t.font),o=[],c=i=0,l=a.length;l>i;c=++i)h=a[c],o.push(t.fillText(h,r,n+(c+1)*s));return o},canvastext=function(e){return function(){var t,r,n,a,c,i,l,h,s,o,u,d,f,g;return t=e.canvas,r=e.canvas.getContext("2d"),a={x:e.x,y:e.y,w:e.width,h:e.height},n={line:0,character:0},s=(e.text||"").split("\n"),h=fontHeight("font: "+r.font),g=function(){var e,c;return e=!0,c=Date.now(),function(i){var l,o;return null==i&&(i=!0),r.clearRect(a.x,a.y,a.w,a.h),drawtext(t,r,a.x,a.y,s),i&&e&&(l=a.x+r.measureText(s[n.line].substr(0,n.character)).width,o=a.y+n.line*h,r.beginPath(),r.moveTo(l,o),r.lineTo(l,o+h),r.stroke()),Date.now()-c>=450?(e=!e,c=Date.now()):void 0}}(),setInterval(g,500),i=function(e){return s[n.line]=s[n.line].slice(0,n.character)+e+s[n.line].substr(n.character),n.character++,g()},f=function(){var e,t,r,a;if(n.character>0)return n.character--,s[n.line]=s[n.line].slice(0,n.character)+s[n.line].substr(n.character+1),g();if(n.line>0){for(n.line--,n.character=s[n.line].length,s[n.line]+=s[n.line+1],e=t=r=n.line+1,a=s.length-1;a>=r?a>t:t>a;e=a>=r?++t:--t)s[e]=s[e+1];return s.pop(),g()}},c=function(){var e,t,r,a;if(n.character<s[n.line].length)return s[n.line]=s[n.line].slice(0,n.character)+s[n.line].substr(n.character+1),g();if(n.line<s.length-1){for(s[n.line]+=s[n.line+1],e=t=r=n.line+1,a=s.length-1;a>=r?a>t:t>a;e=a>=r?++t:--t)s[e]=s[e+1];return s.pop(),g()}},l=function(){return n.line++,s.splice(n.line,0,s[n.line-1].substr(n.character)),s[n.line-1]=s[n.line-1].slice(0,n.character),n.character=0,g()},d=function(e){return i(String.fromCharCode(e.keyCode||e.which))},o=function(e){switch(e){case"up":n.line>0&&(n.line--,n.character=Math.min(s[n.line].length,n.character));break;case"down":n.line<s.length-1?(n.line++,n.character=Math.min(s[n.line].length,n.character)):n.character=s[n.line].length;break;case"left":n.character>0?n.character--:n.line>0&&(n.line--,n.character=s[n.line].length);break;case"right":n.character<s[n.line].length?n.character++:n.line<s.length-1&&(n.line++,n.character=0);break;case"lineStart":n.character=0;break;case"start":n.character=0,n.line=0;break;case"lineEnd":n.character=s[n.line].length;break;case"end":n.line=s.length-1,n.character=s[n.line].length}return g()},u=function(e){var t;switch(t=e.keyCode||e.which){case 8:f();break;case 13:l();break;case 35:o(e.ctrlKey?"end":"lineEnd");break;case 36:o(e.ctrlKey?"start":"lineStart");break;case 37:o("left");break;case 38:o("up");break;case 39:o("right");break;case 40:o("down");break;case 46:c();break;default:return}return e.preventDefault()},document.addEventListener("keypress",d),document.addEventListener("keydown",u),o("end"),{dispose:function(){return document.addEventListener("keypress",d),document.addEventListener("keydown",u),g(!1)}}}()},module.exports={field:canvastext,draw:drawtext};

},{"./fontHeight":2}],2:[function(require,module,exports){
module.exports=function(e){var t,d,n,o;return t=document.getElementsByTagName("body")[0],d=document.createElement("div"),n=document.createTextNode("M"),d.appendChild(n),d.setAttribute("style",e),t.appendChild(d),o=d.offsetHeight,t.removeChild(d),o};

},{}]},{},[1])(1)
});